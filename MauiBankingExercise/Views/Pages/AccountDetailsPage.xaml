<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:controls="clr-namespace:MauiBankingExercise.Views.Controls"
             x:Class="MauiBankingExercise.Views.Pages.AccountDetailsPage"
             Title="{Binding Account.AccountNumber}"
             BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#1E1E1E}">

    <Grid RowDefinitions="Auto,*,Auto">
        <!-- Account Header -->
        <StackLayout Grid.Row="0">
            <!-- Account Balance Card -->
            <controls:BalanceCard Title="{Binding Account.AccountType.Name}"
                                 Balance="{Binding Account.AccountBalance}"
                                 Subtitle="{Binding Account.AccountNumber}" />

            <!-- Actions -->
            <StackLayout Orientation="Horizontal" 
                        HorizontalOptions="Center" 
                        Padding="20,8,20,16">
                <Button Text="Make Transaction" 
                       Command="{Binding MakeTransactionCommand}"
                       BackgroundColor="{AppThemeBinding Light=#1976D2, Dark=#1565C0}"
                       TextColor="White"
                       CornerRadius="20"
                       Padding="24,12" />
                <Button Text="Refresh" 
                       Command="{Binding RefreshCommand}"
                       BackgroundColor="{AppThemeBinding Light=#757575, Dark=#616161}"
                       TextColor="White"
                       CornerRadius="20"
                       Padding="24,12"
                       Margin="12,0,0,0" />
            </StackLayout>
        </StackLayout>

        <!-- Transactions -->
        <RefreshView Grid.Row="1" 
                     IsRefreshing="{Binding IsBusy}" 
                     Command="{Binding RefreshCommand}">
            <CollectionView ItemsSource="{Binding Transactions}"
                           Margin="8,0">
                <CollectionView.Header>
                    <StackLayout Padding="12,8">
                        <Label Text="Transaction History" 
                               FontSize="18" 
                               FontAttributes="Bold"
                               TextColor="{AppThemeBinding Light=Black, Dark=White}" />
                    </StackLayout>
                </CollectionView.Header>
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <controls:TransactionCard Transaction="{Binding}" />
                    </DataTemplate>
                </CollectionView.ItemTemplate>
                <CollectionView.EmptyView>
                    <StackLayout Padding="40" VerticalOptions="CenterAndExpand">
                        <Label Text="No transactions yet" 
                               FontSize="16" 
                               TextColor="{AppThemeBinding Light=#666666, Dark=#CCCCCC}"
                               HorizontalOptions="Center" />
                        <Label Text="Make your first transaction to see it here" 
                               FontSize="14" 
                               TextColor="{AppThemeBinding Light=#999999, Dark=#999999}"
                               HorizontalOptions="Center"
                               Margin="0,8,0,0" />
                    </StackLayout>
                </CollectionView.EmptyView>
            </CollectionView>
        </RefreshView>

        <!-- Error Message -->
        <Label Grid.Row="2" 
               Text="{Binding Error}" 
               IsVisible="{Binding HasError}"
               BackgroundColor="{AppThemeBinding Light=#FFEBEE, Dark=#B71C1C}"
               TextColor="{AppThemeBinding Light=#C62828, Dark=White}"
               Padding="16,12"
               Margin="16,8" />
    </Grid>
</ContentPage>